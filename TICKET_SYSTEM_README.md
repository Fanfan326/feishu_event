# 工单管理系统

基于 Flask 的 Web 工单管理系统，包含用户认证、权限控制和完整的 CRUD 功能。

## 功能特性

✅ **用户认证系统**
- 用户注册和登录
- 密码加密存储（SHA256）
- 会话管理

✅ **权限控制**
- 登录验证（所有页面需要登录）
- 管理员权限（删除工单等功能）
- 角色管理（admin/user）

✅ **工单管理**
- 创建工单
- 查看工单列表（支持搜索和筛选）
- 查看工单详情
- 编辑工单
- 更新工单状态
- 删除工单（管理员）

✅ **评论系统**
- 为工单添加评论
- 查看评论历史

✅ **数据筛选**
- 按状态筛选
- 按优先级筛选
- 关键词搜索

## 快速开始

### 1. 安装依赖

```bash
pip3 install flask
```

### 2. 启动系统

```bash
python3 ticket_system.py
```

### 3. 访问系统

打开浏览器访问：`http://127.0.0.1:5000`

### 4. 默认账户

**管理员账户：**
- 用户名: `admin`
- 密码: `admin123`

首次运行会自动创建此账户。

## 使用说明

### 登录/注册

1. 首次使用需要注册账户，或使用默认管理员账户登录
2. 登录后可以访问所有功能

### 创建工单

1. 点击"创建工单"按钮
2. 填写工单信息：
   - 标题（必填）
   - 描述
   - 状态（待处理/处理中/已完成/已关闭）
   - 优先级（高/中/低）
   - 负责人
   - 标签（用逗号分隔）

### 查看和编辑工单

1. 在工单列表中点击工单标题查看详情
2. 点击"编辑"按钮修改工单信息
3. 在详情页可以快速更新状态

### 添加评论

在工单详情页底部可以添加评论，用于跟踪处理进度。

## 数据库

系统使用 SQLite 数据库（`tickets.db`），包含以下表：

- `users` - 用户表
- `tickets` - 工单表
- `comments` - 评论表

首次运行会自动创建数据库和表结构。

## API 接口

- `POST /api/ticket/<id>/status` - 更新工单状态
- `DELETE /api/ticket/<id>` - 删除工单（管理员）
- `GET /api/stats` - 获取统计信息

## 注意事项

1. 默认管理员密码是 `admin123`，建议首次登录后修改
2. 生产环境请修改 `SECRET_KEY`
3. 数据库文件 `tickets.db` 会保存在当前目录

## 文件结构

```
ticket_system.py          # 主程序文件
templates/                # HTML模板目录
  ├── base.html          # 基础模板
  ├── login.html         # 登录页面
  ├── register.html      # 注册页面
  ├── index.html         # 工单列表
  ├── ticket_detail.html # 工单详情
  ├── edit_ticket.html   # 编辑工单
  └── error.html         # 错误页面
tickets.db               # SQLite数据库（自动创建）
```
